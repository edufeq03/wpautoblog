{% extends "base.html" %}
{% block title %}Fila de Ideias - WP AutoBlog{% endblock %}

{% block content %}
<div class="p-6">
    <div class="flex flex-col md:flex-row items-center justify-between gap-4 mb-8">
        <div>
            <h1 class="text-2xl font-bold text-gray-800">Fila de Ideias</h1>
            <p class="text-sm text-gray-500">Gerencie e transforme sugestões da IA em artigos.</p>
        </div>
        <form action="{{ url_for('dashboard.generate_ideas') }}" method="POST">
            <input type="hidden" name="site_id" value="{{ request.args.get('site_id', '') }}">
            <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2.5 rounded-lg font-semibold shadow-lg">
                <i class="fas fa-magic"></i> Gerar Novas Ideias
            </button>
        </form>
    </div>

    <div class="mb-6">
        <label class="text-xs font-bold text-gray-400 uppercase mb-2 block">Site Ativo:</label>
        {% if current_user.sites|length > 1 %}
            <select onchange="window.location.href='/ideas?site_id=' + this.value" class="bg-white border border-gray-200 py-2 px-4 rounded-lg outline-none">
                <option value="">Todos os sites</option>
                {% for site in current_user.sites %}
                    <option value="{{ site.id }}" {% if request.args.get('site_id')|int == site.id %}selected{% endif %}>{{ site.site_name }}</option>
                {% endfor %}
            </select>
        {% else %}
            <div class="inline-flex items-center gap-2 bg-gray-100 px-4 py-2 rounded-lg text-gray-700 border">
                <i class="fas fa-globe text-blue-500"></i> {{ current_user.sites[0].site_name if current_user.sites else 'Nenhum site' }}
            </div>
        {% endif %}
    </div>

    <div class="grid grid-cols-1 gap-4">
        {% for idea in ideas %}
        <div class="bg-white p-5 rounded-xl border border-gray-100 shadow-sm flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="flex-1">
                <div class="flex items-center gap-2 mb-1">
                    <span class="text-[10px] font-bold bg-blue-50 text-blue-600 px-2 py-0.5 rounded uppercase">{{ idea.blog.site_name if idea.blog else 'Sem Blog' }}</span>
                    <span class="text-[10px] text-gray-400 italic">{{ idea.created_at.strftime('%d/%m/%Y') }}</span>
                </div>
                <p class="text-gray-700 font-medium">{{ idea.title }}</p>
            </div>
            <div class="flex items-center gap-2">
                <form action="{{ url_for('dashboard.delete_idea', idea_id=idea.id) }}" method="POST">
                    <button type="submit" class="p-2.5 text-gray-400 hover:text-red-500"><i class="fas fa-trash-alt"></i></button>
                </form>
                <a href="{{ url_for('dashboard.publish_idea', idea_id=idea.id) }}" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm font-bold flex items-center gap-2">
                    <i class="fas fa-paper-plane"></i> Postar Agora
                </a>
            </div>
        </div>
        {% else %}
        <div class="text-center py-16 bg-white rounded-2xl border-2 border-dashed">
            <p class="text-gray-400">Sua fila está vazia.</p>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}